<!DOCTYPE html>
<html lang="en-us">
<head>
    <meta charset="UTF-8">
    <title>Thomas Pelletier | Virtualization as development tool</title>

    <link rel="copyright" href="http://creativecommons.org/licenses/by-nc-sa/3.0/" type="text/html;charset=utf-8"/>

    <!-- Feed -->
    <link href="http://feeds.feedburner.com/ThomasPelletier"
          rel="alternate" title="Thomas Pelletier"
          type="application/atom+xml"/>

     <!-- OpenID -->
    <link rel="openid.server" href="http://www.myopenid.com/server" />
    <link rel="openid.delegate" href="http://pelletiert.myopenid.com/" />
    <link rel="openid2.local_id" href="http://pelletiert.myopenid.com" />
    <link rel="openid2.provider" href="http://www.myopenid.com/server" />
    <meta http-equiv="X-XRDS-Location" content="http://www.myopenid.com/xrds?username=pelletiert.myopenid.com" />

    <!-- Google webmaster tools -->
    <meta name="google-site-verification" content="kPgkbW4Fp5VsBrbrhH3B_OMQNgBHMh-nTfNl5DJX6J4" />

    <!-- Handled -->
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>

    <!-- The 1140px Grid -->
    <link rel="stylesheet" href="/assets/css/1140-cbb7aab4218.css" type="text/css" media="screen" />

    <!--[if lte IE 9]>
    <link rel="stylesheet" href="/assets/css/ie-cb786208ca6.css" type="text/css" media="screen" />
    <![endif]-->

    <link href='http://fonts.googleapis.com/css?family=Crimson+Text:regular,regularitalic,600,600italic,bold,bolditalic' rel='stylesheet' type='text/css'>

    <link rel="stylesheet" href="/assets/css/smallerscreen-cba2add5881.css" media="only screen and (max-width: 1023px)" />
    <link rel="stylesheet" href="/assets/css/mobile-cb71f52e9d9.css" media="handheld, only screen and (max-width: 767px)" />
    <link rel="stylesheet" href="/assets/css/screen-cb563f0e3d8.css" type="text/css" media="screen" />
    <link rel="stylesheet" href="/assets/css/smaller_screen-cbe79d4b54a.css" media="only screen and (max-width: 1023px)" />
    <link rel="stylesheet" href="/assets/css/mobile_custom-cbe0612c514.css" media="handheld, only screen and (max-width: 767px)" />
    <link rel="stylesheet" href="/assets/css/syntax-cb0d36c27fc.css" type="text/css" />

    <!-- Javascript -->
    <script type="text/javascript" src="/assets/js/jquery-1.4.4.min-cb73a9c334c.js"></script>
    <script type="text/javascript" src="/assets/js/jquery.timeago-cba50fad29f.js"></script>
</head>
<body>

<div class="thin"></div>
<a class="ribbon" href="/"></a>

<div class="inner">
    <div class="container">
        <div class="post_back">
    <a href="/">Home</a>
</div>



<div class="row post">
    <div class="twelvecol">
        <div class="post_title">
            <h1>Virtualization as development tool <a href="/2010/05/virtualization-as-development-tool/">»</a></h1>
        </div>
        <p class="date">Published on May 21, 2010.
        
        </p>
        <a href="http://twitter.com/share" class="twitter-share-button" data-count="vertical">Tweet</a>

        <p>Okay, the title is not well choosen, that&#39;s because my prefered one is too long for the blog layout: Linux Virtualization for a nicer development workplace.</p>

<p>Why using virtualization? In my opinion, the anwser this quite simple. Today, computers are widely able to virtualize at least one operating system (the guest) <em>without GUI</em>. Consequently you can use a virtual system to run a pre-production or a testing environement, more similar to the final production system, and without spoiling your so loved work environement. In my case, I use a virtual machine which runs the exact same software as the final production server does (NGinx, Gunicorn, Django, CouchDB, RabbitMQ, Debian), so I can for example solve many deployment problems, well, before they happen! Furthermore, virtual machines <em>are</em> containted in files. Want to see what would happen if you would upgrade your production server to the latest version? Just copy your current VM, upgrade it, and see the result :)
Now that I&#39;m sure you want to virtualize thousands of system, let take a look at the way I achieve this.</p>

<p>In this example, I use Ubuntu Lucid as host and Debian Lenny as guest.</p>

<p>First, install kvm and qemu in your Ubuntu host:</p>
<pre>sudo apt-get install kvm qemu
</pre>
<p>If you (like me) run an Intel-based computer, load the proper kernel module:</p>
<pre>sudo modprobe kvm-intel
</pre>
<p>Now let&#39;s add your user to the kvm group (you <em>must</em> run KVM machines from a user who is in the kvm group) :</p>
<pre>sudo adduser thomas kvm
</pre>
<p>Then create a folder for our virtualized systems:</p>
<pre>mkdir ~/Virtualization
</pre>
<p>Create a file which will contain our VM (here I ask it to use a dynamic-sized file: only the used space will be written on the hard disk, and it can be up to 6GB):</p>
<pre>qemu-img create -f qcow2 Virtualization/base.img 6G
</pre>
<p><a href="http://caesar.acc.umu.se/debian-cd/5.0.4/i386/iso-cd/debian-504-i386-netinst.iso">Download Debian Lenny</a>.</p>

<p>Let&#39;s start the VM with the downloaded ISO mounted in the cdrom drive, and allow it 256MB of memory:</p>
<pre>kvm -m 256 -cdrom ~/Téléchargements/debian-504-i386-netinst.iso -boot d Virtualization/base.img
</pre>
<p>Then install Debian the way you like it.</p>

<p>Finally, run your VM:</p>
<pre>kvm -m 256 Virtualization/base.img
</pre>
    </div>
</div>

<div class="row post disqus">
    <div class="twelvecol">
        <div id="disqus_thread"></div>
        <script type="text/javascript">
            var disqus_shortname = 'kiznet';
            (function() {
                var dsq = document.createElement('script');
                dsq.type = 'text/javascript';
                dsq.async = true;
                dsq.src = 'http://' + disqus_shortname + '.disqus.com/embed.js';
                (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
            })();
        </script>
    </div>
</div>

<script type="text/javascript" src="http://platform.twitter.com/widgets.js"></script>

    </div>
</div>

<div class="footer">
    <div class="footer_bar">
        <div class="container">
            <div class="row">
                <div class="fourcol">
                    <h3>Latest blog entries</h3>
                    <ul class="latest">
  
    <li>
      <a href="/2012/02/switching-to-nanoc/">Switching to nanoc, and more</a>
    </li>
  
    <li>
      <a href="/2012/01/freebsd-afp-timemachine-updated/">FreeBSD, AFP, Time Machine</a>
    </li>
  
    <li>
      <a href="/2011/12/kindle/">Kindle</a>
    </li>
  
    <li>
      <a href="/2011/09/mixing-django-forms/">Mixing Django Forms</a>
    </li>
  
    <li>
      <a href="/2011/05/convex-hull-ocaml/">Convex hull algorithm in Ocaml</a>
    </li>
  
    <li>
      <a href="/2011/04/git-django-deployment/">Git-based Django deployment</a>
    </li>
  
</ul>

                </div>
                <div class="fourcol">
                    <h3>Quicklinks</h3>
                    <ul>
                        <li><a href="/archives/">Blog archives</a></li>
                        <li><a href="http://github.com/pelletier">GitHub page</a></li>
                        <li><a href="/colophon/">Colophon</a></li>
                    </ul>
                </div>
                <div class="fourcol last contact">
                    <ul>
                        <li>
                            <a href="mailto:pelletier.thomas@gmail.com"
                               class="mail" title='Mail'><span>Email</span></a>
                        </li>
                        <li>
                            <a href="http://twitter.com/thompelletier/"
                               class="twitter"
                               title='Twitter'><span>Twitter</span></a>
                        </li>
                    </ul>
                </div>
            </div>
        </div>
    </div>
</div>

<div class="final_bar">
    <div class="row">
        <div class="twelvecol copyright">
            &copy; 2008 - <span class='now'>now</span> Thomas Pelletier &bull;

            <a href="http://creativecommons.org/licenses/by-sa/3.0/"
               rel="license">CC BY-SA</a>

           &bull;
           Fork me on
           <a href="https://github.com/pelletier/blog/">Github</a>

        </div>
    </div>
</div>

<script type="text/javascript" src="/assets/js/site-cb6bd57e135.js"></script>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-17713470-1', 'pelletierthomas.com');
  ga('send', 'pageview');
</script>
</body>
</html>
